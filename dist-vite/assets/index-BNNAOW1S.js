(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(o){if(o.ep)return;o.ep=!0;const c=s(o);fetch(o.href,c)}})();const te="modulepreload",oe=function(e,t){return new URL(e,t).href},R={},C=function(t,s,n){let o=Promise.resolve();if(s&&s.length>0){let l=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};const a=document.getElementsByTagName("link"),r=document.querySelector("meta[property=csp-nonce]"),i=r?.nonce||r?.getAttribute("nonce");o=l(s.map(d=>{if(d=oe(d,n),d in R)return;R[d]=!0;const u=d.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(n)for(let g=a.length-1;g>=0;g--){const f=a[g];if(f.href===d&&(!u||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${m}`))return;const y=document.createElement("link");if(y.rel=u?"stylesheet":te,u||(y.as="script"),y.crossOrigin="",y.href=d,i&&y.setAttribute("nonce",i),document.head.appendChild(y),u)return new Promise((g,f)=>{y.addEventListener("load",g),y.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${d}`)))})}))}function c(a){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=a,window.dispatchEvent(r),!r.defaultPrevented)throw a}return o.then(a=>{for(const r of a||[])r.status==="rejected"&&c(r.reason);return t().catch(c)})};const _={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};const U=([e,t,s])=>{const n=document.createElementNS("http://www.w3.org/2000/svg",e);return Object.keys(t).forEach(o=>{n.setAttribute(o,String(t[o]))}),s?.length&&s.forEach(o=>{const c=U(o);n.appendChild(c)}),n},ne=(e,t={})=>{const n={..._,...t};return U(["svg",n,e])};const se=e=>Array.from(e.attributes).reduce((t,s)=>(t[s.name]=s.value,t),{}),ae=e=>typeof e=="string"?e:!e||!e.class?"":e.class&&typeof e.class=="string"?e.class.split(" "):e.class&&Array.isArray(e.class)?e.class:"",re=e=>e.flatMap(ae).map(s=>s.trim()).filter(Boolean).filter((s,n,o)=>o.indexOf(s)===n).join(" "),ie=e=>e.replace(/(\w)(\w*)(_|-|\s*)/g,(t,s,n)=>s.toUpperCase()+n.toLowerCase()),q=(e,{nameAttr:t,icons:s,attrs:n})=>{const o=e.getAttribute(t);if(o==null)return;const c=ie(o),a=s[c];if(!a)return console.warn(`${e.outerHTML} icon name was not found in the provided icons object.`);const r=se(e),i={..._,"data-lucide":o,...n,...r},l=re(["lucide",`lucide-${o}`,r,n]);l&&Object.assign(i,{class:l});const d=ne(a,i);return e.parentNode?.replaceChild(d,e)};const ce=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326"}]];const le=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z"}],["circle",{cx:"12",cy:"13",r:"3"}]];const de=[["path",{d:"m6 9 6 6 6-6"}]];const ue=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335"}],["path",{d:"m9 11 3 3L22 4"}]];const me=[["path",{d:"M12 15V3"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["path",{d:"m7 10 5 5 5-5"}]];const ye=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}],["path",{d:"M3 3v5h5"}],["path",{d:"M12 7v5l4 2"}]];const ge=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56"}]];const pe=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3"}]];const we=[["path",{d:"M5 12h14"}]];const fe=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}],["path",{d:"M21 3v5h-5"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}],["path",{d:"M8 16H3v5"}]];const he=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915"}],["circle",{cx:"12",cy:"12",r:"3"}]];const ke=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z"}]];const be=[["path",{d:"M10 11v6"}],["path",{d:"M14 11v6"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}],["path",{d:"M3 6h18"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}]];const ve=[["path",{d:"M12 3v12"}],["path",{d:"m17 8-5-5-5 5"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}]];const Ie=[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]];const M=({icons:e={},nameAttr:t="data-lucide",attrs:s={},root:n=document,inTemplates:o}={})=>{if(!Object.values(e).length)throw new Error(`Please provide an icons object.
If you want to use all the icons you can import it like:
 \`import { createIcons, icons } from 'lucide';
lucide.createIcons({icons});\``);if(typeof n>"u")throw new Error("`createIcons()` only works in a browser environment.");if(Array.from(n.querySelectorAll(`[${t}]`)).forEach(a=>q(a,{nameAttr:t,icons:e,attrs:s})),o&&Array.from(n.querySelectorAll("template")).forEach(r=>M({icons:e,nameAttr:t,attrs:s,root:r.content,inTemplates:o})),t==="data-lucide"){const a=n.querySelectorAll("[icon-name]");a.length>0&&(console.warn("[Lucide] Some icons were found with the now deprecated icon-name attribute. These will still be replaced for backwards compatibility, but will no longer be supported in v1.0 and you should switch to data-lucide"),Array.from(a).forEach(r=>q(r,{nameAttr:"icon-name",icons:e,attrs:s})))}};async function b(){const e={mastodonToken:document.getElementById("mastodon-token").value,twitterKey:document.getElementById("twitter-key").value,twitterSecret:document.getElementById("twitter-secret").value,twitterToken:document.getElementById("twitter-token").value,twitterTokenSecret:document.getElementById("twitter-token-secret").value,blueskyPassword:document.getElementById("bluesky-password").value},t={mastodonInstance:document.getElementById("mastodon-instance").value,blueskyHandle:document.getElementById("bluesky-handle").value,platforms:{...window.platforms},pollingIntervals:{mastodon:parseInt(document.getElementById("mastodonInterval").value)||5,twitter:parseInt(document.getElementById("twitterInterval").value)||60,bluesky:parseInt(document.getElementById("blueskyInterval").value)||5},notificationExclusions:{mastodon:document.getElementById("excludeMastodonNotifications").checked,twitter:document.getElementById("excludeTwitterNotifications").checked,bluesky:document.getElementById("excludeBlueskyNotifications").checked},windowControlsStyle:document.getElementById("windowControlsStyle").value||"macos-circles"};try{const s=await window.electron.encryptCredentials(JSON.stringify(e));localStorage.setItem("socialSoxEncryptedCredentials",s)}catch(s){console.error("Failed to encrypt credentials:",s),localStorage.setItem("socialSoxCredentials",JSON.stringify({...e,...t}));return}localStorage.setItem("socialSoxSettings",JSON.stringify(t))}async function z(){try{let e={},t={};const s=localStorage.getItem("socialSoxEncryptedCredentials");if(s)try{const o=await window.electron.decryptCredentials(s);e=JSON.parse(o)}catch(o){console.error("Failed to parse old credentials:",o),localStorage.removeItem("socialSoxEncryptedCredentials"),window.showStatus?.("Corrupted encrypted credentials cleared. Please re-enter your credentials.","info")}const n=localStorage.getItem("socialSoxSettings");if(n)try{t=JSON.parse(n)}catch(o){console.error("Failed to parse settings:",o),localStorage.removeItem("socialSoxSettings")}if(!s&&!n){const o=localStorage.getItem("socialSoxCredentials");if(o)try{const c=JSON.parse(o);e={mastodonToken:c.mastodonToken||"",twitterKey:c.twitterKey||"",twitterSecret:c.twitterSecret||"",twitterToken:c.twitterToken||"",twitterTokenSecret:c.twitterTokenSecret||"",blueskyPassword:c.blueskyPassword||""},t={mastodonInstance:c.mastodonInstance||"",blueskyHandle:c.blueskyHandle||"",platforms:c.platforms||{},pollingIntervals:c.pollingIntervals||{},notificationExclusions:c.notificationExclusions||{}},await b()}catch(c){console.error("Failed to parse old credentials:",c),localStorage.removeItem("socialSoxCredentials"),window.showStatus?.("Corrupted credentials cleared. Please re-enter your credentials.","info")}}document.getElementById("mastodon-instance").value=t.mastodonInstance||"",document.getElementById("mastodon-token").value=e.mastodonToken||"",document.getElementById("twitter-key").value=e.twitterKey||"",document.getElementById("twitter-secret").value=e.twitterSecret||"",document.getElementById("twitter-token").value=e.twitterToken||"",document.getElementById("twitter-token-secret").value=e.twitterTokenSecret||"",document.getElementById("bluesky-handle").value=t.blueskyHandle||"",document.getElementById("bluesky-password").value=e.blueskyPassword||"",t.platforms&&Object.assign(window.platforms,t.platforms),t.pollingIntervals?(document.getElementById("mastodonInterval").value=t.pollingIntervals.mastodon||5,document.getElementById("mastodonIntervalValue").textContent=t.pollingIntervals.mastodon||5,document.getElementById("twitterInterval").value=t.pollingIntervals.twitter||60,document.getElementById("twitterIntervalValue").textContent=t.pollingIntervals.twitter||60,document.getElementById("blueskyInterval").value=t.pollingIntervals.bluesky||5,document.getElementById("blueskyIntervalValue").textContent=t.pollingIntervals.bluesky||5):(document.getElementById("mastodonInterval").value=5,document.getElementById("mastodonIntervalValue").textContent=5,document.getElementById("twitterInterval").value=60,document.getElementById("twitterIntervalValue").textContent=60,document.getElementById("blueskyInterval").value=5,document.getElementById("blueskyIntervalValue").textContent=5),t.notificationExclusions&&(document.getElementById("excludeMastodonNotifications").checked=t.notificationExclusions.mastodon||!1,document.getElementById("excludeTwitterNotifications").checked=t.notificationExclusions.twitter||!1,document.getElementById("excludeBlueskyNotifications").checked=t.notificationExclusions.bluesky||!1),t.windowControlsStyle?document.getElementById("windowControlsStyle").value=t.windowControlsStyle:document.getElementById("windowControlsStyle").value="macos-circles",V(t.windowControlsStyle||"macos-circles"),document.querySelectorAll(".platform-toggle").forEach(o=>{const c=o.dataset.platform,a=window.platforms[c];o.classList.toggle("active",a),a?(o.classList.remove("border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-gray-800","dark:text-gray-200"),o.classList.add("border-primary-500","bg-primary-500","text-white")):(o.classList.add("border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-gray-800","dark:text-gray-200"),o.classList.remove("border-primary-500","bg-primary-500","text-white"))})}catch(e){console.error("Error loading credentials from localStorage:",e),window.showStatus?.('Error loading saved credentials. Storage may be corrupted. Try "Reset All Data" in Settings.',"error")}}async function J(){try{const e={mastodonInstance:document.getElementById("mastodon-instance").value,mastodonToken:document.getElementById("mastodon-token").value,twitterKey:document.getElementById("twitter-key").value,twitterSecret:document.getElementById("twitter-secret").value,twitterToken:document.getElementById("twitter-token").value,twitterTokenSecret:document.getElementById("twitter-token-secret").value,blueskyHandle:document.getElementById("bluesky-handle").value,blueskyPassword:document.getElementById("bluesky-password").value};if(window.electron&&window.electron.exportCredentials){const t=await window.electron.exportCredentials(e);t.success?window.showStatus("Credentials exported successfully!","success"):t.canceled||window.showStatus("Failed to export credentials: "+t.error,"error")}else{const t=JSON.stringify(e,null,2),s=new Blob([t],{type:"application/json"}),n=URL.createObjectURL(s),o=document.createElement("a");o.href=n,o.download="socialsox-credentials.json",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(n),window.showStatus("Credentials exported to download!","success")}}catch(e){window.showStatus("Export failed: "+e.message,"error")}}async function F(){try{if(window.electron&&window.electron.importCredentials){const e=await window.electron.importCredentials();if(e.success&&e.credentials){const t=e.credentials;document.getElementById("mastodon-instance").value=t.mastodonInstance||"",document.getElementById("mastodon-token").value=t.mastodonToken||"",document.getElementById("twitter-key").value=t.twitterKey||"",document.getElementById("twitter-secret").value=t.twitterSecret||"",document.getElementById("twitter-token").value=t.twitterToken||"",document.getElementById("twitter-token-secret").value=t.twitterTokenSecret||"",document.getElementById("bluesky-handle").value=t.blueskyHandle||"",document.getElementById("bluesky-password").value=t.blueskyPassword||"",await b(),window.showStatus("Credentials imported successfully!","success")}else e.canceled||window.showStatus("Failed to import credentials: "+e.error,"error")}else{const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async t=>{const s=t.target.files[0];if(s)try{const n=await s.text(),o=JSON.parse(n);document.getElementById("mastodon-instance").value=o.mastodonInstance||"",document.getElementById("mastodon-token").value=o.mastodonToken||"",document.getElementById("twitter-key").value=o.twitterKey||"",document.getElementById("twitter-secret").value=o.twitterSecret||"",document.getElementById("twitter-token").value=o.twitterToken||"",document.getElementById("twitter-token-secret").value=o.twitterTokenSecret||"",document.getElementById("bluesky-handle").value=o.blueskyHandle||"",document.getElementById("bluesky-password").value=o.blueskyPassword||"",await b(),window.showStatus("Credentials imported successfully!","success")}catch(n){window.showStatus("Failed to parse credentials file: "+n.message,"error")}},e.click()}}catch(e){window.showStatus("Import failed: "+e.message,"error")}}function V(e){const t=document.querySelector(".window-controls");if(t){if(t.innerHTML="",e==="lucide-icons"){const s=document.createElement("button");s.className="w-6 h-6 flex items-center justify-center hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors text-gray-800 dark:text-gray-200",s.onclick=()=>window.electron.minimizeWindow(),s.innerHTML='<i data-lucide="minus" class="w-3 h-3"></i>';const n=document.createElement("button");n.className="w-6 h-6 flex items-center justify-center hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors text-gray-800 dark:text-gray-200",n.onclick=()=>window.electron.maximizeWindow(),n.innerHTML='<i data-lucide="maximize" class="w-3 h-3"></i>';const o=document.createElement("button");o.className="w-6 h-6 flex items-center justify-center hover:bg-red-200 dark:hover:bg-red-800 rounded transition-colors text-gray-800 dark:text-gray-200",o.onclick=()=>window.electron.closeWindow(),o.innerHTML='<i data-lucide="x" class="w-3 h-3"></i>',t.appendChild(s),t.appendChild(n),t.appendChild(o)}else{const s=document.createElement("button");s.className="w-3 h-3 rounded-full bg-yellow-400 hover:opacity-70 transition-opacity",s.onclick=()=>window.electron.minimizeWindow();const n=document.createElement("button");n.className="w-3 h-3 rounded-full bg-green-500 hover:opacity-70 transition-opacity",n.onclick=()=>window.electron.maximizeWindow();const o=document.createElement("button");o.className="w-3 h-3 rounded-full bg-red-500 hover:opacity-70 transition-opacity",o.onclick=()=>window.electron.closeWindow(),t.appendChild(s),t.appendChild(n),t.appendChild(o)}typeof lucide<"u"&&typeof window.lucideIcons<"u"&&lucide.createIcons({icons:window.lucideIcons})}}const W=Object.defineProperty({__proto__:null,exportCredentials:J,importCredentials:F,loadCredentials:z,saveCredentials:b,updateWindowControlsStyle:V},Symbol.toStringTag,{value:"Module"});async function Ee(e,t,s,n=null){let o=t.trim();o.endsWith("/")&&(o=o.slice(0,-1));const c=new URL(o);o=`${c.protocol}//${c.host}`;let a=null;if(n){const d=new FormData;d.append("file",n);const u=await fetch(`${o}/api/v2/media`,{method:"POST",headers:{Authorization:`Bearer ${s}`},body:d});if(!u.ok){const y=await u.text();throw new Error(`Image upload failed: ${y}`)}a=(await u.json()).id}const r={status:e};a&&(r.media_ids=[a]);const i=await fetch(`${o}/api/v1/statuses`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(r)});if(!i.ok){const d=await i.text();throw new Error(`${i.status} ${i.statusText}: ${d}`)}return{success:!0,url:(await i.json()).url}}async function xe(e,t,s,n,o,c=null){if(window.electron&&window.electron.postToTwitter){console.log("Calling Electron backend for Twitter...");const a=await window.electron.postToTwitter(e,t,s,n,o,c);if(console.log("Twitter result:",a),!a.success){let r=a.error;throw a.details&&(console.error("Twitter error details:",a.details),a.details.detail?r=a.details.detail:a.details.title&&(r=a.details.title)),new Error(r)}return{success:!0,url:a.url}}else throw new Error("Twitter posting requires Electron app (run: npm start)")}async function Se(e,t,s,n=null){const o=await fetch("https://bsky.social/xrpc/com.atproto.server.createSession",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:t,password:s})});if(!o.ok){const p=await o.text();throw new Error(`Auth failed: ${p}`)}const c=await o.json();let a=null;if(n){const p=await n.arrayBuffer(),w=await fetch("https://bsky.social/xrpc/com.atproto.repo.uploadBlob",{method:"POST",headers:{Authorization:`Bearer ${c.accessJwt}`,"Content-Type":n.type},body:p});if(!w.ok){const v=await w.text();throw new Error(`Image upload failed: ${v}`)}a=(await w.json()).blob}const r=[],i=/(https?:\/\/[^\s]+)/g;let l,d=null;for(;(l=i.exec(e))!==null;){const p=l[0];if(window.electron&&window.electron.fetchOgPreview)try{const w=await window.electron.fetchOgPreview(p);if(w&&w.success&&w.image){const k=Uint8Array.from(atob(w.image),T=>T.charCodeAt(0)),v=await fetch("https://bsky.social/xrpc/com.atproto.repo.uploadBlob",{method:"POST",headers:{Authorization:`Bearer ${c.accessJwt}`,"Content-Type":w.imageType},body:k});if(v.ok){const T=await v.json();d={$type:"app.bsky.embed.external",external:{uri:p,title:w.title||"",description:w.description||"",thumb:T.blob}},r.push({index:{byteStart:new TextEncoder().encode(e.slice(0,l.index)).length,byteEnd:new TextEncoder().encode(e.slice(0,l.index+l[0].length)).length},features:[{$type:"app.bsky.richtext.facet#link",uri:p}]});break}}}catch(w){console.error("OG preview error:",w)}r.push({index:{byteStart:new TextEncoder().encode(e.slice(0,l.index)).length,byteEnd:new TextEncoder().encode(e.slice(0,l.index+l[0].length)).length},features:[{$type:"app.bsky.richtext.facet#link",uri:l[0]}]})}const u={text:e,createdAt:new Date().toISOString()};d&&(u.embed=d);const m=/(^|\s)(#[A-Za-z0-9_]+)/g;for(;(l=m.exec(e))!==null;){const p=l[2],w=l.index+(l[1]?l[1].length:0),k=w+p.length;r.push({index:{byteStart:new TextEncoder().encode(e.slice(0,w)).length,byteEnd:new TextEncoder().encode(e.slice(0,k)).length},features:[{$type:"app.bsky.richtext.facet#link",uri:"https://bsky.app/hashtag/"+encodeURIComponent(p.replace(/^#/,""))}]})}r.length>0&&(u.facets=r),a&&(u.embed={$type:"app.bsky.embed.images",images:[{alt:"",image:a}]});const y=await fetch("https://bsky.social/xrpc/com.atproto.repo.createRecord",{method:"POST",headers:{Authorization:`Bearer ${c.accessJwt}`,"Content-Type":"application/json"},body:JSON.stringify({repo:c.did,collection:"app.bsky.feed.post",record:u})});if(!y.ok){const p=await y.text();throw new Error(`Post failed: ${p}`)}const f=(await y.json()).uri.split("/").pop();return{success:!0,url:`https://bsky.app/profile/${c.did}/post/${f}`}}function E(e,t){const s=document.getElementById("status");s.textContent=e,s.className="mt-5 p-4 rounded-lg text-sm whitespace-pre-line block",t==="success"?(s.classList.add("bg-green-100","dark:bg-green-900","text-green-800","dark:text-green-200","border","border-green-300","dark:border-green-600"),setTimeout(()=>{s.classList.add("hidden")},5e3)):t==="error"?s.classList.add("bg-red-100","dark:bg-red-900","text-red-800","dark:text-red-200","border","border-red-300","dark:border-red-600"):t==="info"&&s.classList.add("bg-blue-100","dark:bg-blue-900","text-blue-800","dark:text-blue-200","border","border-blue-300","dark:border-blue-600")}function Be(e,t="info",s=3e3){const n=document.getElementById("toastContainer"),o=document.createElement("div");o.className=`toast ${t}`,o.textContent=e,n.appendChild(o),setTimeout(()=>{o.classList.add("fade-out"),setTimeout(()=>{o.parentNode&&o.parentNode.removeChild(o)},300)},s)}function K(){const t=document.getElementById("message").value.length,s=document.getElementById("charCount");s.textContent=`${t} characters`,s.className="text-right text-xs mb-5",t>280?s.classList.add("text-red-500"):t>250?s.classList.add("text-orange-500"):s.classList.add("text-gray-500","dark:text-gray-400")}function $(e){document.querySelectorAll(".tab-content").forEach(s=>{s.classList.add("hidden")}),document.querySelectorAll(".tab-button").forEach(s=>{s.classList.remove("text-primary-600","dark:text-primary-400","border-primary-600","dark:border-primary-400"),s.classList.add("text-gray-500","dark:text-gray-400","border-transparent")}),document.getElementById(e+"Content").classList.remove("hidden"),document.getElementById(e+"Tab").classList.remove("text-gray-500","dark:text-gray-400","border-transparent"),document.getElementById(e+"Tab").classList.add("text-primary-600","dark:text-primary-400","border-b-2","border-primary-600","dark:border-primary-400"),document.getElementById("status").classList.add("hidden")}function Te(){const e=document.getElementById("credentials"),t=document.getElementById("arrow");e.style.maxHeight==="1000px"?(e.style.maxHeight="0",t.style.transform="rotate(0deg)"):(e.style.maxHeight="1000px",t.style.transform="rotate(180deg)")}function Le(){const e=JSON.parse(localStorage.getItem("postingHistory")||"[]");A(e)}function Ne(e){localStorage.setItem("postingHistory",JSON.stringify(e))}function Ce(){confirm("Are you sure you want to clear all posting history? This action cannot be undone.")&&(localStorage.removeItem("postingHistory"),A([]),window.showToast("Posting history cleared","success"))}function $e(e,t,s){const n=JSON.parse(localStorage.getItem("postingHistory")||"[]"),o={timestamp:new Date().toISOString(),message:e,platforms:t,results:s};n.unshift(o),n.length>100&&n.splice(100),Ne(n),A(n)}function A(e){const t=document.getElementById("historyList"),s=document.getElementById("noHistory");if(e.length===0){t.innerHTML="",s.style.display="block";return}s.style.display="none",t.innerHTML=e.map(n=>{const c=new Date(n.timestamp).toLocaleString(),a=n.platforms.join(", "),r=n.results.map(i=>i.success?`<a href="${i.url}" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 underline">✓ ${i.platform}</a>`:`<span class="text-red-600 dark:text-red-400">✗ ${i.platform}: ${i.error}</span>`).join("<br>");return`
            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600">
                <div class="flex justify-between items-start mb-2">
                    <span class="text-xs text-gray-500 dark:text-gray-400">${c}</span>
                    <span class="text-xs text-gray-600 dark:text-gray-300">${a}</span>
                </div>
                <p class="text-sm text-gray-800 dark:text-gray-200 mb-2 whitespace-pre-wrap">${n.message}</p>
                <div class="text-xs text-gray-600 dark:text-gray-400">${r}</div>
            </div>
        `}).join("")}let P=null;function Me(){const e=document.getElementById("dropZone"),t=document.getElementById("fileInput");e.addEventListener("click",()=>{t.click()}),t.addEventListener("change",s=>{const n=s.target.files[0];n&&n.type.startsWith("image/")&&N(n)}),e.addEventListener("dragover",s=>{s.preventDefault(),e.classList.add("border-primary-500","bg-gray-100","dark:bg-gray-600")}),e.addEventListener("dragleave",()=>{e.classList.remove("border-primary-500","bg-gray-100","dark:bg-gray-600")}),e.addEventListener("drop",s=>{s.preventDefault(),e.classList.remove("border-primary-500","bg-gray-100","dark:bg-gray-600");const n=s.dataTransfer.files[0];n&&n.type.startsWith("image/")&&N(n)}),document.addEventListener("paste",async s=>{const n=await window.electron.readClipboardImage();if(n){const o=Ae(n,"clipboard-image.png");N(o)}})}function N(e){if(e.size>5*1024*1024){window.showStatus("Image too large! Max size is 5MB","error");return}P=e;const t=new FileReader;t.onload=s=>{document.getElementById("previewImg").src=s.target.result,document.getElementById("dropZone").classList.add("hidden"),document.getElementById("imagePreview").classList.remove("hidden")},t.readAsDataURL(e)}function G(){P=null,document.getElementById("dropZone").classList.remove("hidden"),document.getElementById("imagePreview").classList.add("hidden"),document.getElementById("fileInput").value=""}function Ae(e,t){const s=e.split(","),n=s[0].match(/:(.*?);/)[1],o=atob(s[1]);let c=o.length;const a=new Uint8Array(c);for(;c--;)a[c]=o.charCodeAt(c);return new File([a],t,{type:n})}function Pe(){return P}let S={mastodon:null,twitter:null,bluesky:null};function x(){const e=localStorage.getItem("allNotifications");return e?JSON.parse(e):[]}function L(e){localStorage.setItem("allNotifications",JSON.stringify(e))}function Z(){localStorage.removeItem("allNotifications"),localStorage.removeItem("mastodonLastNotificationId"),localStorage.removeItem("twitterLastMentionId"),localStorage.removeItem("blueskyLastNotificationTimestamp");const e=document.getElementById("notificationsList"),t=document.getElementById("noNotifications");e.innerHTML="",t.style.display="block",t.textContent='Click "Load Notifications" to check for replies, likes, and mentions across your platforms.',window.showStatus("Notification cache cleared!","success")}function O(){j();const e=JSON.parse(localStorage.getItem("socialSoxSettings")||"{}"),t=e.pollingIntervals||{mastodon:5,twitter:60,bluesky:5},s=e.notificationExclusions||{};["mastodon","twitter","bluesky"].filter(n=>!s[n]).forEach(n=>{const c=t[n]*60*1e3;S[n]=setInterval(()=>{console.log(`Auto-checking ${n} notifications...`),D(n,!0)},c)})}function I(){O()}function j(){Object.keys(S).forEach(e=>{S[e]&&(clearInterval(S[e]),S[e]=null)})}async function D(e,t=!0){const s=e.charAt(0).toUpperCase()+e.slice(1);window.showToast(`Checking ${s}...`,"info",t?1500:2e3);const n=[];try{if(e==="mastodon"){const r=document.getElementById("mastodon-instance").value,i=document.getElementById("mastodon-token").value;if(r&&i){const l=localStorage.getItem("mastodonLastNotificationId"),d=await Oe(r,i,l);if(n.push(...d.map(u=>({...u,platform:"mastodon"}))),d.length>0){const u=Math.max(...d.map(m=>parseInt(m.id)));localStorage.setItem("mastodonLastNotificationId",u.toString())}}}else if(e==="twitter"){const r=document.getElementById("twitter-key").value,i=document.getElementById("twitter-secret").value,l=document.getElementById("twitter-token").value,d=document.getElementById("twitter-token-secret").value;if(r&&i&&l&&d){const u=await je(r,i,l,d);n.push(...u.map(m=>({...m,platform:"twitter"})))}}else if(e==="bluesky"){const r=document.getElementById("bluesky-handle").value,i=document.getElementById("bluesky-password").value;if(r&&i){const l=await De(r,i);if(n.push(...l.map(d=>({...d,platform:"bluesky"}))),l.length>0){const d=l.reduce((u,m)=>new Date(m.timestamp)>new Date(u)?m.timestamp:u,l[0].timestamp);localStorage.setItem("blueskyLastNotificationTimestamp",d)}}}const o=x(),c=new Set(o.map(r=>r.id)),a=n.filter(r=>!c.has(r.id)).map(r=>({...r,isNew:!0}));if(a.length>0){const r=[...o,...a];if(localStorage.setItem("allNotifications",JSON.stringify(r)),B(r),window.electron&&window.electron.showOSNotification){const i=a.length,l=e.charAt(0).toUpperCase()+e.slice(1);window.electron.showOSNotification(`New ${l} notifications`,`You have ${i} new notification${i>1?"s":""} on ${l}`,e)}}}catch(o){if(console.error(`${e} notifications error:`,o),o.message.toLowerCase().includes("rate limit")){const c={id:`error-${e}-${Date.now()}`,platform:e,error:!0,message:o.message,timestamp:new Date().toISOString()},a=x();a.push(c),L(a),B(a),setTimeout(()=>{H(c.id)},1e4)}else t||window.showStatus(`Failed to load ${e} notifications: ${o.message}`,"error")}}async function Q(e=!1){const t=document.getElementById("loadNotificationsBtn");document.getElementById("notificationsList");const s=document.getElementById("noNotifications");e||(t.disabled=!0,t.innerHTML='<i data-lucide="loader-2" class="w-4 h-4 animate-spin"></i> Loading...',typeof lucide<"u"&&typeof window.lucideIcons<"u"&&lucide.createIcons({icons:window.lucideIcons})),s.style.display="none";try{const o=JSON.parse(localStorage.getItem("socialSoxSettings")||"{}").notificationExclusions||{},a=["mastodon","twitter","bluesky"].filter(i=>!o[i]).map(i=>D(i,e));await Promise.all(a);const r=x();B(r),e||window.showStatus("Notifications loaded!","success")}catch(n){console.error("Error loading notifications:",n),e||window.showStatus(`Error loading notifications: ${n.message}`,"error")}finally{e||(t.disabled=!1,t.innerHTML='<i data-lucide="refresh-cw" class="w-4 h-4"></i> Load Notifications',typeof lucide<"u"&&typeof window.lucideIcons<"u"&&lucide.createIcons({icons:window.lucideIcons}))}}function H(e){const t=x(),s=t.find(n=>n.id===e);s&&(s.dismissed=!0,s.isNew=!1,L(t),B(t))}function X(){const e=x();let t=!1;e.forEach(s=>{(!s.dismissed||s.isNew)&&(s.dismissed=!0,s.isNew=!1,t=!0)}),t?(L(e),B(e),window.showToast("All notifications marked as read","success")):window.showToast("No unread notifications to mark","info")}function Y(){window.electron&&window.electron.showOSNotification?(window.electron.showOSNotification("Test Notification","This is a test notification from SocialSox!","test"),window.showToast("Test notification sent!","success")):window.showToast("Notifications not supported","error")}async function Oe(e,t,s=null){let n=e.trim();n.endsWith("/")&&(n=n.slice(0,-1));const o=new URL(n);n=`${o.protocol}//${o.host}`;let c=`${n}/api/v1/notifications?limit=20`;s&&(c+=`&since_id=${s}`);const a=await fetch(c,{method:"GET",headers:{Authorization:`Bearer ${t}`}});if(!a.ok)throw a.status===403?new Error("Access denied. Check your Mastodon access token is valid and has read:notifications scope."):new Error(`${a.status} ${a.statusText}`);const r=await a.json();return await Promise.all(r.map(async l=>{let d="";l.status?.url?d=l.status.url:l.status?.account?.acct&&n?(d=`${n}/@${l.status.account.acct}`,l.status?.id&&(d+=`/${l.status.id}`)):d=l.account?.url||"";let u=null,m=null;if(l.type==="mention"&&l.status?.in_reply_to_id)try{const g=await fetch(`${n}/api/v1/statuses/${l.status.in_reply_to_id}`,{headers:{Authorization:`Bearer ${t}`}});g.ok&&(u=(await g.json()).content?.replace(/<[^>]*>/g,"")||"")}catch(g){console.warn("Failed to fetch parent status:",g)}else if(l.type==="mention"&&l.status?.content){const g=l.status.content,f=/https?:\/\/([^\/]+)\/@[^\/]+\/(\d+)/g;let h;const p=[];for(;(h=f.exec(g))!==null;)p.push({instance:h[1],statusId:h[2],fullUrl:h[0]});if(p.length>0){const{instance:w,statusId:k}=p[0];try{const v=await fetch(`https://${w}/api/v1/statuses/${k}`,{headers:{Authorization:`Bearer ${t}`}});v.ok&&(m=(await v.json()).content?.replace(/<[^>]*>/g,"")||"")}catch(v){console.warn("Failed to fetch quoted status:",v)}}}let y=null;return(l.type==="favourite"||l.type==="reblog")&&l.status?.content&&(y=l.status.content.replace(/<[^>]*>/g,"")||""),{id:l.id,type:l.type,timestamp:l.created_at,author:l.account?.display_name||l.account?.username||"Unknown",authorHandle:l.account?.acct||"",content:l.status?.content?.replace(/<[^>]*>/g,"")||"",subjectContent:y,replyingTo:u,quotingTo:m,url:d}}))}async function je(e,t,s,n){if(typeof window.electron>"u"||!window.electron.fetchTwitterNotifications)throw new Error("Twitter notifications require Electron app. Restart with: npm start");const o=localStorage.getItem("twitterLastMentionId"),c=await window.electron.fetchTwitterNotifications(e,t,s,n,o);if(!c.success)throw c.error&&c.error.includes("Too Many Requests")?new Error("Twitter rate limit reached. Wait 15 minutes before retrying."):new Error(c.error);return c.latestId&&localStorage.setItem("twitterLastMentionId",c.latestId),c.data}async function De(e,t){const s=await fetch("https://bsky.social/xrpc/com.atproto.server.createSession",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:e,password:t})});if(!s.ok)throw new Error("Auth failed");const n=await s.json(),o=await fetch("https://bsky.social/xrpc/app.bsky.notification.listNotifications?limit=25",{method:"GET",headers:{Authorization:`Bearer ${n.accessJwt}`}});if(!o.ok)throw new Error(`${o.status} ${o.statusText}`);const c=await o.json();return await Promise.all(c.notifications.map(async r=>{let i=null;const l=r.author?.did;let d=null,u=null,m=null;if(r.reason==="follow")l&&(i=`https://bsky.app/profile/${l}`);else if(r.reason==="like"||r.reason==="repost"){const y=r.record?.subject?.uri;if(y){const g=y.split("/"),f=g[2],h=g[g.length-1];if(f&&h){i=`https://bsky.app/profile/${f}/post/${h}`;try{const p=await fetch(`https://bsky.social/xrpc/com.atproto.repo.getRecord?repo=${f}&collection=app.bsky.feed.post&rkey=${h}`,{headers:{Authorization:`Bearer ${n.accessJwt}`}});p.ok&&(d=(await p.json()).value?.text||"")}catch(p){console.warn("Failed to fetch subject post:",p)}}}}else if(r.reason==="reply"){const y=r.uri.split("/"),g=y[y.length-1];if(l&&g&&(i=`https://bsky.app/profile/${l}/post/${g}`,r.record?.reply?.parent?.uri)){const h=r.record.reply.parent.uri.split("/"),p=h[2],w=h[y.length-1];try{const k=await fetch(`https://bsky.social/xrpc/com.atproto.repo.getRecord?repo=${p}&collection=app.bsky.feed.post&rkey=${w}`,{headers:{Authorization:`Bearer ${n.accessJwt}`}});k.ok&&(u=(await k.json()).value?.text||"")}catch(k){console.warn("Failed to fetch parent post:",k)}}}else if(r.reason==="quote"){const y=r.uri.split("/"),g=y[y.length-1];if(l&&g&&(i=`https://bsky.app/profile/${l}/post/${g}`,r.record?.embed?.record?.uri)){const h=r.record.embed.record.uri.split("/"),p=h[2],w=h[h.length-1];try{const k=await fetch(`https://bsky.social/xrpc/com.atproto.repo.getRecord?repo=${p}&collection=app.bsky.feed.post&rkey=${w}`,{headers:{Authorization:`Bearer ${n.accessJwt}`}});k.ok&&(m=(await k.json()).value?.text||"")}catch(k){console.warn("Failed to fetch quoted post:",k)}}}else if(r.uri){const y=r.uri.split("/"),g=y[y.length-1];l&&g&&(i=`https://bsky.app/profile/${l}/post/${g}`)}return{id:r.uri,type:r.reason,timestamp:r.indexedAt,author:r.author?.displayName||r.author?.handle||"Unknown",authorHandle:r.author?.handle||"",content:r.record?.text||"",subjectContent:d,replyingTo:u,quotingTo:m,isRead:r.isRead,url:i}}))}function B(e){const t=document.getElementById("notificationsList"),s=document.getElementById("noNotifications"),n=e.filter(a=>!a.dismissed);if(n.sort((a,r)=>new Date(r.timestamp)-new Date(a.timestamp)),n.length===0){t.innerHTML="",s.style.display="block",s.textContent="No notifications!";return}s.style.display="none";const o={mastodon:'<img src="assets/masto.svg" alt="M" class="w-4 h-4 inline-block dark:brightness-0 dark:invert">',twitter:'<img src="assets/twit.svg" alt="X" class="w-4 h-4 inline-block dark:brightness-0 dark:invert">',bluesky:'<img src="assets/bsky.svg" alt="B" class="w-4 h-4 inline-block dark:brightness-0 dark:invert">'},c={mention:"Mentioned you",reply:"Replied to you",reblog:"Reposted",favourite:"Liked",like:"Liked",repost:"Reposted",follow:"Followed you",quote:"Quoted you"};t.innerHTML=n.map(a=>{if(a.error)return`
                <div class="bg-red-50 dark:bg-red-900/20 rounded-lg p-4 border border-red-200 dark:border-red-800">
                    <div class="flex items-center gap-2 mb-2">
                        ${o[a.platform]||""}
                        <span class="text-xs font-semibold text-red-700 dark:text-red-300">${a.platform.toUpperCase()}</span>
                    </div>
                    <p class="text-sm text-red-800 dark:text-red-200">${a.message}</p>
                </div>
            `;const i=new Date(a.timestamp).toLocaleString(),l=c[a.type]||a.type,d=a.isNew?"border-primary-500 bg-primary-50 dark:bg-primary-900/10":"",u=a.isNew?'<span class="text-xs bg-primary-600 text-white px-2 py-0.5 rounded-full">New</span>':"";return`
            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600 ${d}">
                <div class="flex justify-between items-start mb-2">
                    <div class="flex items-center gap-2">
                        ${o[a.platform]||""}
                        <span class="text-xs font-semibold text-gray-700 dark:text-gray-300">${a.platform.toUpperCase()}</span>
                        <span class="text-xs text-gray-500 dark:text-gray-400">•</span>
                        <span class="text-xs text-primary-600 dark:text-primary-400">${l}</span>
                        ${u}
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="text-xs text-gray-500 dark:text-gray-400">${i}</span>
                        <button onclick="markAsSeen('${a.id}'); event.stopPropagation();" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 text-sm leading-none w-4 h-4 flex items-center justify-center rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors" title="Dismiss">×</button>
                    </div>
                </div>
                <div class="mb-2">
                    <span class="text-sm font-medium text-gray-800 dark:text-gray-200">${a.author}</span>
                    ${a.authorHandle?`<span class="text-xs text-gray-500 dark:text-gray-400">@${a.authorHandle}</span>`:""}
                </div>
                ${(()=>{let m=a.content;return(a.type==="like"||a.type==="repost"||a.type==="favourite"||a.type==="reblog")&&a.subjectContent?(m=a.subjectContent,`<div class="mb-2 p-2 bg-gray-100 dark:bg-gray-600 rounded text-xs text-gray-600 dark:text-gray-400">${m.substring(0,150)}${m.length>150?"...":""}</div>`):a.type==="mention"?`<div class="mb-2 p-2 bg-gray-100 dark:bg-gray-600 rounded text-xs text-gray-600 dark:text-gray-400">${m.substring(0,150)}${m.length>150?"...":""}</div>`:m?`<p class="text-sm text-gray-700 dark:text-gray-300 mb-2">${m.substring(0,200)}${m.length>200?"...":""}</p>`:""})()}
                ${a.replyingTo?`<div class="mb-2 p-2 bg-gray-100 dark:bg-gray-600 rounded text-xs text-gray-600 dark:text-gray-400"><strong>Replying to:</strong> ${a.replyingTo.substring(0,150)}${a.replyingTo.length>150?"...":""}</div>`:""}
                ${a.quotingTo?`<div class="mb-2 p-2 bg-gray-100 dark:bg-gray-600 rounded text-xs text-gray-600 dark:text-gray-400"><strong>Quoting:</strong> ${a.quotingTo.substring(0,150)}${a.quotingTo.length>150?"...":""}</div>`:""}
                ${a.url?`<a href="${a.url}" class="text-xs text-primary-600 dark:text-primary-400 hover:underline">View on ${a.platform}</a>`:""}
            </div>
        `}).join("")}const He=Object.defineProperty({__proto__:null,clearNotificationsCache:Z,getAllCachedNotifications:x,loadNotifications:Q,loadPlatformNotifications:D,markAllAsRead:X,markAsSeen:H,notificationPollingIntervals:S,restartNotificationPolling:I,saveAllNotifications:L,startNotificationPolling:O,stopNotificationPolling:j,testNotification:Y},Symbol.toStringTag,{value:"Module"}),ee={PenSquare:ke,History:ye,Bell:ce,Settings:he,Camera:le,Trash2:be,RefreshCw:fe,CheckCircle:ue,ChevronDown:de,Download:me,Upload:ve,Minus:we,Maximize:pe,X:Ie,Loader2:ge};window.lucide={createIcons:M};window.lucideIcons=ee;window.platforms={mastodon:!1,twitter:!1,bluesky:!1};window.showStatus=E;window.showToast=Be;window.switchTab=$;window.toggleCollapsible=Te;window.removeImage=G;window.exportCredentials=J;window.importCredentials=F;window.clearHistory=Ce;window.clearNotificationsCache=Z;window.loadNotifications=Q;window.markAsSeen=H;window.markAllAsRead=X;window.testNotification=Y;window.resetAllData=qe;window.addEventListener("DOMContentLoaded",async()=>{await z(),Le(),window.electron.getVersion().then(i=>{document.getElementById("version").textContent=`v${i}`});const e=localStorage.getItem("socialSoxDarkMode"),t=e!==null?e==="true":!0;document.getElementById("darkModeToggle").checked=t,t&&document.documentElement.classList.add("dark");const s=localStorage.getItem("socialSoxTrayEnabled"),n=s!==null?s==="true":!1;document.getElementById("trayIconToggle").checked=n,document.getElementById("trayIconSection").style.display=n?"block":"none",window.electron.setTrayEnabled(n);const o=localStorage.getItem("socialSoxTrayIconPath")||"tray.png";o==="tray.png"?window.electron.getDefaultTrayIconPath().then(i=>{window.electron.readFileAsDataURL(i).then(l=>{l&&(document.getElementById("trayIconPreview").src=l)})}):window.electron.readFileAsDataURL(o).then(i=>{i&&(document.getElementById("trayIconPreview").src=i)}),window.electron.setTrayIcon(o);const c=localStorage.getItem("socialSoxExternalLinks"),a=c!==null?c==="true":!1;document.getElementById("externalLinksToggle").checked=a,x().length>0&&C(()=>Promise.resolve().then(()=>He),void 0,import.meta.url).then(i=>{}),O(),window.electron&&window.electron.onSwitchToNotificationsTab&&window.electron.onSwitchToNotificationsTab(()=>{$("notifications")}),M({icons:ee}),document.getElementById("message").addEventListener("input",K),document.querySelectorAll(".tab-button").forEach(i=>{i.addEventListener("click",function(){$(this.dataset.tab)})}),document.getElementById("darkModeToggle").addEventListener("change",function(){const i=this.checked;localStorage.setItem("socialSoxDarkMode",i),i?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}),document.getElementById("trayIconToggle").addEventListener("change",function(){const i=this.checked;localStorage.setItem("socialSoxTrayEnabled",i),document.getElementById("trayIconSection").style.display=i?"block":"none",window.electron.setTrayEnabled(i)}),document.getElementById("externalLinksToggle").addEventListener("change",function(){const i=this.checked;localStorage.setItem("socialSoxExternalLinks",i)}),document.getElementById("windowControlsStyle").addEventListener("change",function(){const i=this.value;C(()=>Promise.resolve().then(()=>W),void 0,import.meta.url).then(l=>{l.updateWindowControlsStyle(i)})}),document.querySelectorAll(".platform-toggle").forEach(i=>{i.addEventListener("click",async function(){const l=this.dataset.platform;window.platforms[l]=!window.platforms[l],this.classList.toggle("active"),window.platforms[l]?(this.classList.remove("border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-gray-800","dark:text-gray-200"),this.classList.add("border-primary-500","bg-primary-500","text-white")):(this.classList.add("border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-gray-800","dark:text-gray-200"),this.classList.remove("border-primary-500","bg-primary-500","text-white")),await b()})}),document.querySelectorAll("input").forEach(i=>{i.addEventListener("change",async()=>await b())}),document.getElementById("mastodonInterval").addEventListener("input",async function(){document.getElementById("mastodonIntervalValue").textContent=this.value,await b(),I()}),document.getElementById("twitterInterval").addEventListener("input",async function(){document.getElementById("twitterIntervalValue").textContent=this.value,await b(),I()}),document.getElementById("blueskyInterval").addEventListener("input",async function(){document.getElementById("blueskyIntervalValue").textContent=this.value,await b(),I()}),document.getElementById("excludeMastodonNotifications").addEventListener("change",function(){b(),I()}),document.getElementById("excludeTwitterNotifications").addEventListener("change",function(){b(),I()}),document.getElementById("excludeBlueskyNotifications").addEventListener("change",function(){b(),I()}),Me(),document.addEventListener("click",function(i){i.target.tagName==="A"&&i.target.href&&(i.preventDefault(),localStorage.getItem("socialSoxExternalLinks")==="true"?window.electron.openExternalLink(i.target.href):window.open(i.target.href,"_blank"))}),window.chooseTrayIcon=function(){window.electron.openFileDialog().then(i=>{i&&window.electron.readFileAsDataURL(i).then(l=>{l?(document.getElementById("trayIconPreview").src=l,localStorage.setItem("socialSoxTrayIconPath",i),window.electron.setTrayIcon(i)):E("Failed to load image","error")})})}});async function Re(){const e=document.getElementById("message").value.trim();if(!e){E("Please enter a message","error");return}const t=Object.keys(window.platforms).filter(a=>window.platforms[a]);if(t.length===0){E("Please select at least one platform","error");return}const s=document.getElementById("postBtn");s.disabled=!0,s.textContent="Posting...";const n=[],o=Pe();let c=null;if(o){const a=new FileReader;c=await new Promise(r=>{a.onload=i=>r(i.target.result),a.readAsDataURL(o)})}try{if(window.platforms.mastodon){const d=document.getElementById("mastodon-instance").value,u=document.getElementById("mastodon-token").value;if(d&&u)try{const m=await Ee(e,d,u,o);n.push({platform:"Mastodon",success:!0,url:m.url})}catch(m){n.push({platform:"Mastodon",success:!1,error:m.message})}else n.push({platform:"Mastodon",success:!1,error:"Missing credentials"})}if(window.platforms.twitter){const d=document.getElementById("twitter-key").value,u=document.getElementById("twitter-secret").value,m=document.getElementById("twitter-token").value,y=document.getElementById("twitter-token-secret").value;if(d&&u&&m&&y)try{const g=await xe(e,d,u,m,y,c);n.push({platform:"Twitter",success:!0,url:g.url})}catch(g){let f=g.message;(f.includes("403")||f.includes("Forbidden"))&&(f='Permission denied. Make sure your Twitter app has "Read and Write" permissions in Developer Portal, then regenerate your Access Token and Access Token Secret.'),n.push({platform:"Twitter",success:!1,error:f})}else n.push({platform:"Twitter",success:!1,error:"Missing credentials"})}if(window.platforms.bluesky){const d=document.getElementById("bluesky-handle").value,u=document.getElementById("bluesky-password").value;if(d&&u)try{const m=await Se(e,d,u,o);n.push({platform:"Bluesky",success:!0,url:m.url})}catch(m){n.push({platform:"Bluesky",success:!1,error:m.message})}else n.push({platform:"Bluesky",success:!1,error:"Missing credentials"})}const a=n.some(d=>d.success),r=n.some(d=>!d.success);let i="info";a&&!r&&(i="success"),r&&(i="error");const l=n.map(d=>d.success?`✓ ${d.platform}`:`✗ ${d.platform}: ${d.error}`);E(l.join(`
`),i),$e(e,t,n),a&&!r&&(document.getElementById("message").value="",K(),G())}catch(a){E("Error: "+a.message,"error")}finally{s.disabled=!1,s.textContent="Post to Selected Platforms"}}function qe(){if(!confirm(`⚠️ WARNING: This will permanently delete ALL your credentials, history, notifications, and settings. This action cannot be undone!

Are you absolutely sure you want to reset everything?`))return;localStorage.clear(),document.getElementById("mastodon-instance").value="",document.getElementById("mastodon-token").value="",document.getElementById("twitter-key").value="",document.getElementById("twitter-secret").value="",document.getElementById("twitter-token").value="",document.getElementById("twitter-token-secret").value="",document.getElementById("bluesky-handle").value="",document.getElementById("bluesky-password").value="",Object.keys(window.platforms).forEach(o=>{window.platforms[o]=!1;const c=document.querySelector(`.platform-toggle[data-platform="${o}"]`);c&&(c.classList.remove("active","border-primary-500","bg-primary-500","text-white"),c.classList.add("border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-gray-800","dark:text-gray-200"))}),document.getElementById("mastodonInterval").value=5,document.getElementById("mastodonIntervalValue").textContent=5,document.getElementById("twitterInterval").value=60,document.getElementById("twitterIntervalValue").textContent=60,document.getElementById("blueskyInterval").value=5,document.getElementById("blueskyIntervalValue").textContent=5,document.getElementById("excludeMastodonNotifications").checked=!1,document.getElementById("excludeTwitterNotifications").checked=!1,document.getElementById("excludeBlueskyNotifications").checked=!1,document.getElementById("darkModeToggle").checked=!0,document.documentElement.classList.add("dark"),document.getElementById("trayIconToggle").checked=!1,document.getElementById("trayIconSection").style.display="none",window.electron&&window.electron.setTrayEnabled&&window.electron.setTrayEnabled(!1),document.getElementById("externalLinksToggle").checked=!1,document.getElementById("windowControlsStyle").value="macos-circles",C(()=>Promise.resolve().then(()=>W),void 0,import.meta.url).then(o=>{o.updateWindowControlsStyle("macos-circles")});const e=document.getElementById("historyList"),t=document.getElementById("noHistory");e.innerHTML="",t.style.display="block";const s=document.getElementById("notificationsList"),n=document.getElementById("noNotifications");s.innerHTML="",n.style.display="block",n.textContent='Click "Load Notifications" to check for replies, likes, and mentions across your platforms.',j(),E("All data has been reset! Please restart the app for a complete fresh start.","success")}window.postToAll=Re;
